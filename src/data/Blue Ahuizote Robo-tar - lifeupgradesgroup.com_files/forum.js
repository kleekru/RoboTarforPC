$(function(){$(".relatize").relatizeDate();$("textarea.richeditor").markItUp({previewParserPath:"",markupSet:[{name:"Picture",key:"P",replaceWith:"[img][![Url]!][/img]"},{name:"Link",key:"L",openWith:"[url=[![Url]!]]",closeWith:"[/url]",placeHolder:"Your text to link here..."},{name:"Quotes",openWith:"[quote]",closeWith:"[/quote]"},{name:"Embed",openWith:"[embed]",closeWith:"[/embed]"}]});$("#toggle_post_topic").click(function(){$("#topic_create form").slideToggle();return false})});
window.img_check=setInterval(function(){var a=0;$(".body img").each(function(){if(this.width>480){this.width=480;this.height=480*(this.height/this.width)}this.complete!=true&&a++});a==0&&clearInterval(window.img_check)},100);function set_member_level(a,d,c){var b=b||false;$.post("/admin/js/setmemberlevel/",{lvl:d,uid:a},function(g){c&&c(g)});return false}
function delete_topic(a){var d="#topic_"+a;$("#reply_list,"+d+" h1,"+d+" .topic_meta,"+d+" .body").toggleClass("deleted");if($(d+" .body").hasClass("deleted")){$(d+" .delete_topic").html("Undelete Topic");d="1"}else{$(d+" .delete_topic").html("Delete Topic");d="0"}$.post("/api/v1/flag_topic/",{topic_id:a,deleted:d},function(c){});return false}
function delete_reply(a){var d="#reply_"+a;$(d+" .reply_meta,"+d+" .body").toggleClass("deleted");if($(d+" .body").hasClass("deleted")){$(d+" .delete_reply").html("Undelete");d="1"}else{$(d+" .delete_reply").html("Delete");d="0"}$.post("/api/v1/flag_reply/",{reply_id:a,deleted:d},function(c){});return false}function flag_topic_as_spam(a){return false}function flag_reply_as_spam(a){return false};(function(a){a.fn.hoverIntent=function(d,c){var b={sensitivity:7,interval:100,timeout:0};b=a.extend(b,c?{over:d,out:c}:d);var g,j,n,l,o=function(f){g=f.pageX;j=f.pageY},x=function(f,h){h.hoverIntent_t=clearTimeout(h.hoverIntent_t);if(Math.abs(n-g)+Math.abs(l-j)<b.sensitivity){a(h).unbind("mousemove",o);h.hoverIntent_s=1;return b.over.apply(h,[f])}else{n=g;l=j;h.hoverIntent_t=setTimeout(function(){x(f,h)},b.interval)}},k=function(f,h){h.hoverIntent_t=clearTimeout(h.hoverIntent_t);h.hoverIntent_s=0;
return b.out.apply(h,[f])};d=function(f){for(var h=(f.type=="mouseover"?f.fromElement:f.toElement)||f.relatedTarget;h&&h!=this;)try{h=h.parentNode}catch(u){h=this}if(h==this)return false;var v=jQuery.extend({},f),s=this;if(s.hoverIntent_t)s.hoverIntent_t=clearTimeout(s.hoverIntent_t);if(f.type=="mouseover"){n=v.pageX;l=v.pageY;a(s).bind("mousemove",o);if(s.hoverIntent_s!=1)s.hoverIntent_t=setTimeout(function(){x(v,s)},b.interval)}else{a(s).unbind("mousemove",o);if(s.hoverIntent_s==1)s.hoverIntent_t=
setTimeout(function(){k(v,s)},b.timeout)}};return this.mouseover(d).mouseout(d)}})(jQuery);(function(a){a.fn.markItUp=function(d,c){var b,g,j,n;g=j=n=false;b={id:"",nameSpace:"",root:"",previewInWindow:"",previewAutoRefresh:true,previewPosition:"after",previewTemplatePath:"~/templates/preview.html",previewParserPath:"",previewParserVar:"data",resizeHandle:true,beforeInsert:"",afterInsert:"",onEnter:{},onShiftEnter:{},onCtrlEnter:{},onTab:{},markupSet:[{}]};a.extend(b,d,c);b.root||a("script").each(function(l,o){miuScript=a(o).get(0).src.match(/(.*)jquery\.markitup(\.pack)?\.js$/);if(miuScript!==
null)b.root=miuScript[1]});return this.each(function(){function l(e,i){if(i)return e.replace(/("|')~\//g,"$1"+b.root);return e.replace(/^~\//,b.root)}function o(){nameSpace=id="";if(b.id)id='id="'+b.id+'"';else if(m.attr("id"))id='id="markItUp'+m.attr("id").substr(0,1).toUpperCase()+m.attr("id").substr(1)+'"';if(b.nameSpace)nameSpace='class="'+b.nameSpace+'"';m.wrap("<div "+nameSpace+"></div>");m.wrap("<div "+id+' class="markItUp"></div>');m.wrap('<div class="markItUpContainer"></div>');m.addClass("markItUpEditor");
E=a('<div class="markItUpHeader"></div>').insertBefore(m);a(x(b.markupSet)).appendTo(E);J=a('<div class="markItUpFooter"></div>').insertAfter(m);if(b.resizeHandle===true&&a.browser.safari!==true){resizeHandle=a('<div class="markItUpResizeHandle"></div>').insertAfter(m).bind("mousedown",function(e){var i=m.height(),q=e.clientY,p,y;p=function(F){m.css("height",Math.max(20,F.clientY+i-q)+"px");return false};y=function(){a("html").unbind("mousemove",p).unbind("mouseup",y);return false};a("html").bind("mousemove",
p).bind("mouseup",y)});J.append(resizeHandle)}m.keydown(K).keyup(K);m.bind("insertion",function(e,i){i.target!==false&&G();t===a.markItUp.focused&&u(i)});m.focus(function(){a.markItUp.focused=this})}function x(e){var i=a("<ul></ul>"),q=0;a("li:hover > ul",i).css("display","block");a.each(e,function(){var p=this,y="",F,H;F=p.key?(p.name||"")+" [Ctrl+"+p.key+"]":p.name||"";key=p.key?'accesskey="'+p.key+'"':"";if(p.separator)y=a('<li class="markItUpSeparator">'+(p.separator||"")+"</li>").appendTo(i);
else{q++;for(H=C.length-1;H>=0;H--)y+=C[H]+"-";y=a('<li class="markItUpButton markItUpButton'+y+q+" "+(p.className||"")+'"><a href="" '+key+' title="'+F+'">'+(p.name||"")+"</a></li>").bind("contextmenu",function(){return false}).click(function(){return false}).mouseup(function(){p.call&&eval(p.call)();u(p);return false}).hover(function(){a("> ul",this).show();a(document).one("click",function(){a("ul ul",E).hide()})},function(){a("> ul",this).hide()}).appendTo(i);if(p.dropMenu){C.push(q);a(y).addClass("markItUpDropMenu").append(x(p.dropMenu))}}});
C.pop();return i}function k(e){if(e){e=e.toString();e=e.replace(/\(\!\(([\s\S]*?)\)\!\)/g,function(i,q){i=q.split("|!|");return n===true?i[1]!==undefined?i[1]:i[0]:i[1]===undefined?"":i[0]});return e=e.replace(/\[\!\[([\s\S]*?)\]\!\]/g,function(i,q){i=q.split(":!:");if(D===true)return false;value=prompt(i[0],i[1]?i[1]:"");if(value===null)D=true;return value})}return""}function f(e){if(a.isFunction(e))e=e(B);return k(e)}function h(e){openWith=f(z.openWith);placeHolder=f(z.placeHolder);replaceWith=
f(z.replaceWith);closeWith=f(z.closeWith);block=replaceWith!==""?openWith+replaceWith+closeWith:selection===""&&placeHolder!==""?openWith+placeHolder+closeWith:openWith+(e||selection)+closeWith;return{block:block,openWith:openWith,replaceWith:replaceWith,placeHolder:placeHolder,closeWith:closeWith}}function u(e){var i,q;B=z=e;G();a.extend(B,{line:"",root:b.root,textarea:t,selection:selection||"",caretPosition:r,ctrlKey:g,shiftKey:j,altKey:n});f(b.beforeInsert);f(z.beforeInsert);g===true&&j===true&&
f(z.beforeMultiInsert);a.extend(B,{line:1});if(g===true&&j===true){lines=selection.split(/\r?\n/);e=0;i=lines.length;for(q=0;q<i;q++)if(a.trim(lines[q])!==""){a.extend(B,{line:++e,selection:lines[q]});lines[q]=h(lines[q]).block}else lines[q]="";string={block:lines.join("\n")};start=r;e=string.block.length+(a.browser.opera?i:0)}else if(g===true){string=h(selection);start=r+string.openWith.length;e=string.block.length-string.openWith.length-string.closeWith.length;e-=s(string.block)}else if(j===true){string=
h(selection);start=r;e=string.block.length;e-=s(string.block)}else{string=h(selection);start=r+string.block.length;e=0;start-=s(string.block)}if(selection===""&&string.replaceWith===""){w+=v(string.block);start=r+string.openWith.length;e=string.block.length-string.openWith.length-string.closeWith.length;w=m.val().substring(r,m.val().length).length;w-=v(m.val().substring(0,r))}a.extend(B,{caretPosition:r,scrollPosition:I});if(string.block!==selection&&D===false){N(string.block);L(start,e)}else w=-1;
G();a.extend(B,{line:"",selection:selection});g===true&&j===true&&f(z.afterMultiInsert);f(z.afterInsert);f(b.afterInsert);A&&b.previewAutoRefresh&&O();j=n=g=D=false}function v(e){if(a.browser.opera)return e.length-e.replace(/\n*/g,"").length;return 0}function s(e){if(a.browser.msie)return e.length-e.replace(/\r*/g,"").length;return 0}function N(e){if(document.selection)document.selection.createRange().text=e;else m.val(m.val().substring(0,r)+e+m.val().substring(r+selection.length,m.val().length))}
function L(e,i){if(t.createTextRange){if(a.browser.opera&&a.browser.version>=9.5&&i==0)return false;range=t.createTextRange();range.collapse(true);range.moveStart("character",e);range.moveEnd("character",i);range.select()}else t.setSelectionRange&&t.setSelectionRange(e,e+i);t.scrollTop=I;t.focus()}function G(){t.focus();I=t.scrollTop;if(document.selection){selection=document.selection.createRange().text;if(a.browser.msie){var e=document.selection.createRange(),i=e.duplicate();i.moveToElementText(t);
for(r=-1;i.inRange(e);){i.moveStart("character");r++}}else r=t.selectionStart}else{r=t.selectionStart;selection=m.val().substring(r,t.selectionEnd)}return selection}function O(){P()}function P(){if(b.previewParserPath!=="")a.ajax({type:"POST",url:b.previewParserPath,data:b.previewParserVar+"="+encodeURIComponent(m.val()),success:function(e){M(l(e,1))}});else Q||a.ajax({url:b.previewTemplatePath,success:function(e){M(l(e,1).replace(/<!-- content --\>/g,m.val()))}});return false}function M(e){if(A.document){try{sp=
A.document.documentElement.scrollTop}catch(i){sp=0}A.document.open();A.document.write(e);A.document.close();A.document.documentElement.scrollTop=sp}b.previewInWindow&&A.focus()}function K(e){j=e.shiftKey;n=e.altKey;g=!(e.altKey&&e.ctrlKey)?e.ctrlKey:false;if(e.type==="keydown"){if(g===true){li=a("a[accesskey="+String.fromCharCode(e.keyCode)+"]",E).parent("li");if(li.length!==0){g=false;li.triggerHandler("mouseup");return false}}if(e.keyCode===13||e.keyCode===10)if(g===true){console.log("onCtrlEnter");
g=false;u(b.onCtrlEnter);return b.onCtrlEnter.keepDefault}else if(j===true){console.log("onShiftEnter");j=false;u(b.onShiftEnter);return b.onShiftEnter.keepDefault}else{u(b.onEnter);return b.onEnter.keepDefault}if(e.keyCode===9){if(j==true||g==true||n==true)return false;if(w!==-1){G();w=m.val().length-w;L(w,0);w=-1;return false}else{u(b.onTab);return b.onTab.keepDefault}}}}var m,t,C,I,r,w,z,B,E,J,A,Q,D;m=a(this);t=this;C=[];D=false;I=r=0;w=-1;b.previewParserPath=l(b.previewParserPath);b.previewTemplatePath=
l(b.previewTemplatePath);o()})};a.fn.markItUpRemove=function(){return this.each(function(){$$=a(this).unbind().removeClass("markItUpEditor");$$.parent("div").parent("div.markItUp").parent("div").replaceWith($$)})};a.markItUp=function(d){var c={target:false};a.extend(c,d);if(c.target)return a(c.target).each(function(){a(this).focus();a(this).trigger("insertion",[c])});else a("textarea").trigger("insertion",[c])}})(jQuery);(function(a){a.fn.relatizeDate=function(){return a(this).each(function(){a(this).hasClass("relatized")||a(this).text(a.relatizeDate(this)).addClass("relatized")})};a.relatizeDate=function(d){d=a(d).attr("title");var c=d.match(/(\d\d\d\d)-(\d\d)-(\d\d) (\d\d):(\d\d):(\d\d)/);c=new Date(Date.UTC(c[1],parseInt(c[2],10)-1,parseInt(c[3],10),c[4],c[5]));if(isNaN(c))return d;return a.relatizeDate.timeAgoInWords(c)};$r=a.relatizeDate;a.extend(a.relatizeDate,{shortDays:["Sun","Mon","Tue","Wed","Thu","Fri",
"Sat"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],strftime:function(d,c){var b=d.getDay(),g=d.getMonth(),j=d.getHours(),n=d.getMinutes(),l=function(o){o=o.toString(10);return(new Array(2-o.length+1)).join("0")+o};return c.replace(/\%([aAbBcdHImMpSwyY])/g,function(o){switch(o[1]){case "a":return $r.shortDays[b];
case "A":return $r.days[b];case "b":return $r.shortMonths[g];case "B":return $r.months[g];case "c":return d.toString();case "d":return l(d.getDate());case "H":return l(j);case "I":return l((j+12)%12);case "m":return l(g+1);case "M":return l(n);case "p":return j>12?"PM":"AM";case "S":return l(d.getSeconds());case "w":return b;case "y":return l(d.getFullYear()%100);case "Y":return d.getFullYear().toString()}})},timeAgoInWords:function(d,c){return $r.distanceOfTimeInWords(d,new Date,c)},distanceOfTimeInWords:function(d,
c,b){c=parseInt((c.getTime()-d.getTime())/1E3,10);if(c<60)return"less than a minute ago";else if(c<120)return"about a minute ago";else if(c<2700)return parseInt(c/60,10).toString()+" minutes ago";else if(c<7200)return"about an hour ago";else if(c<86400)return"about "+parseInt(c/3600,10).toString()+" hours ago";else if(c<172800)return"1 day ago";else{c=parseInt(c/86400,10).toString();if(c>5){c="%b %d, %Y";if(b)c+=" %I:%M %p";return $r.strftime(d,c)}else return c+" days ago"}}})})(jQuery);$(function(){$("#base_search form").submit(function(){var a=$("#search_results"),d=$("#base_search input").val();if(!d){a.hide();return false}a.show();a.html('<img src="/static/img/loader.gif" alt="loading">');$.getJSON("/api/v1/search/",{q:d},function(c){var b="";if(c.length==0)b="No results found.";else for(var g=0;g<c.length;g++){var j=c[g];b+='<div class="topic"><h3><a href="'+j.url+'">'+j.title+'</a></h3><div class="meta">posted by '+j.member.name+' <span class="relatize">'+j.created.__value+
"</span></div><div>"+j.excerpt+'</div><div style="margin-left: 20px;">';for(var n=0;n<j.replies.length;n++){var l=j.replies[n];b+='<div class="reply"><h4><a href="'+l.url+'">Re: '+j.title+"</a></h4>";b+='<div class="meta">posted by '+l.member.name+' <span class="relatize">'+l.created.__value+"</span></div>";b+="<div>"+l.excerpt+"</div></div>"}b+="</div></div>"}a.html(b)});return false})});(function(a){a.fn.superfish=function(c){var b=a.fn.superfish,g=b.c,j=a(['<span class="',g.arrowClass,'"> &#187;</span>'].join("")),n=function(){var k=a(this),f=o(k);clearTimeout(f.sfTimer);k.showSuperfishUl().siblings().hideSuperfishUl()},l=function(){var k=a(this),f=o(k),h=b.op;clearTimeout(f.sfTimer);f.sfTimer=setTimeout(function(){h.retainPath=a.inArray(k[0],h.$path)>-1;k.hideSuperfishUl();h.$path.length&&k.parents(["li.",h.hoverClass].join("")).length<1&&n.call(h.$path)},h.delay)},o=function(k){k=
k.parents(["ul.",g.menuClass,":first"].join(""))[0];b.op=b.o[k.serial];return k},x=function(k){k.addClass(g.anchorClass).append(j.clone())};return this.each(function(){var k=this.serial=b.o.length,f=a.extend({},b.defaults,c);f.$path=a("li."+f.pathClass,this).slice(0,f.pathLevels).each(function(){a(this).addClass([f.hoverClass,g.bcClass].join(" ")).filter("li:has(ul)").removeClass(f.pathClass)});b.o[k]=b.op=f;a("li:has(ul)",this)[a.fn.hoverIntent&&!f.disableHI?"hoverIntent":"hover"](n,l).each(function(){f.autoArrows&&
x(a(">a:first-child",this))}).not("."+g.bcClass).hideSuperfishUl();var h=a("a",this);h.each(function(u){var v=h.eq(u).parents("li");h.eq(u).focus(function(){n.call(v)}).blur(function(){l.call(v)})});f.onInit.call(this)}).each(function(){var k=[g.menuClass];b.op.dropShadows&&!(a.browser.msie&&a.browser.version<7)&&k.push(g.shadowClass);a(this).addClass(k.join(" "))})};var d=a.fn.superfish;d.o=[];d.op={};d.IE7fix=function(){var c=d.op;a.browser.msie&&a.browser.version>6&&c.dropShadows&&c.animation.opacity!=
undefined&&this.toggleClass(d.c.shadowClass+"-off")};d.c={bcClass:"sf-breadcrumb",menuClass:"sf-js-enabled",anchorClass:"sf-with-ul",arrowClass:"sf-sub-indicator",shadowClass:"sf-shadow"};d.defaults={hoverClass:"sfHover",pathClass:"overideThisToUse",pathLevels:1,delay:800,animation:{opacity:"show"},speed:"normal",autoArrows:true,dropShadows:true,disableHI:false,onInit:function(){},onBeforeShow:function(){},onShow:function(){},onHide:function(){}};a.fn.extend({hideSuperfishUl:function(){var c=d.op,
b=c.retainPath===true?c.$path:"";c.retainPath=false;b=a(["li.",c.hoverClass].join(""),this).add(this).not(b).removeClass(c.hoverClass).find(">ul").hide().css("visibility","hidden");c.onHide.call(b);return this},showSuperfishUl:function(){var c=d.op,b=this.addClass(c.hoverClass).find(">ul:hidden").css("visibility","visible");d.IE7fix.call(b);c.onBeforeShow.call(b);b.animate(c.animation,c.speed,function(){d.IE7fix.call(b);c.onShow.call(b)});return this}})})(jQuery);(function(a){a.fn.supersubs=function(d){var c=a.extend({},a.fn.supersubs.defaults,d);return this.each(function(){var b=a(this),g=a.meta?a.extend({},c,b.data()):c,j=a('<li id="menu-fontsize">&#8212;</li>').css({padding:0,position:"absolute",top:"-999em",width:"auto"}).appendTo(b).width();a("#menu-fontsize").remove();$ULs=b.find("ul");$ULs.each(function(n){n=$ULs.eq(n);var l=n.children(),o=l.children("a"),x=l.css("white-space","nowrap").css("float"),k=n.add(l).add(o).css({"float":"none",width:"auto"}).end().end()[0].clientWidth/
j;k+=g.extraWidth;if(k>g.maxWidth)k=g.maxWidth;else if(k<g.minWidth)k=g.minWidth;k+="em";n.css("width",k);l.css({"float":x,width:"100%","white-space":"normal"}).each(function(){var f=a(">ul",this),h=f.css("left")!==undefined?"left":"right";f.css(h,k)})})})};a.fn.supersubs.defaults={minWidth:9,maxWidth:25,extraWidth:0}})(jQuery);
